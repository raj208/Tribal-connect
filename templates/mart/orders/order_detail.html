{% extends "base.html" %}
{% block title %}Order #{{ order.id }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Order #{{ order.id }}</h2>
  <span class="badge bg-secondary">{{ order.status }}</span>
</div>

<div class="card p-3 mb-3">
  <h5>Shipping</h5>
  <div>{{ order.full_name }} • {{ order.phone }}</div>
  <div class="text-muted">
    {{ order.address_line1 }}{% if order.address_line2 %}, {{ order.address_line2 }}{% endif %},
    {{ order.city }}, {{ order.state }} - {{ order.pincode }}
  </div>
</div>

<div class="card p-3">
  <h5>Items</h5>
  {% for it in order.items.all %}
  
  <div class="d-flex justify-content-between">
    <div>
      {{ it.title }} <span class="text-muted">x{{ it.quantity }}</span>
      <div class="small text-muted">Status: {{ it.fulfillment_status }}</div>
    </div>
    <div>₹{{ it.line_total }}</div>
  </div>

  {% endfor %}
  <hr>
  <div class="d-flex justify-content-between">
    <div class="text-muted">Subtotal</div>
    <div>₹{{ order.subtotal }}</div>
  </div>
  <div class="d-flex justify-content-between">
    <div class="text-muted">Shipping</div>
    <div>₹{{ order.shipping_fee }}</div>
  </div>
  <hr>
  <div class="d-flex justify-content-between fw-semibold">
    <div>Total</div>
    <div>₹{{ order.total }}</div>
  </div>

  <div class="mt-3">
    {% if order.status == "PENDING" %}
    <a class="btn btn-dark" href="{% url 'payments:pay_order' order.id %}">Pay with Razorpay</a>
    {% else %}
    <button class="btn btn-outline-secondary" disabled>Payment Completed</button>
    {% endif %}
  </div>

</div>
{% endblock %}